# Configuration for a docker-compose environment to run tests for Vertex Framework
version: '3'
services:
  ################################################################
  # Neo4j graph database
  ################################################################
  neo4j:
    image: neo4j:4.2
    environment:
      # Set default password to "vertex"
      NEO4J_AUTH: neo4j/vertex
      # We need APOC functionality like triggers:
      NEO4JLABS_PLUGINS: '["apoc"]'
      # Enable automatic UUID creation on nodes:
      apoc.uuid.enabled: "true"
      apoc.trigger.enabled: "true"
    ports:
      - 7774:7474  # Browse on your host at http://localhost:7774/browser/?connectURL=neo4j://localhost:7777
      - 7777:7687  # Bolt

  ################################################################
  # NodeJS container for tests
  ################################################################
  tester:
    build:
      context: .
    depends_on:
      - neo4j
    stdin_open: true
    tty: true
    volumes:
      - .:/testenv/
